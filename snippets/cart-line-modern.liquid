{%- liquid
  assign item = item | default: line_item
  assign index = index | default: forloop.index

  # Get the best available image with proper fallbacks
  assign line_image = item.image
  unless line_image
    assign line_image = item.variant.image
  endunless
  unless line_image
    assign line_image = item.variant.featured_image
  endunless
  unless line_image
    assign line_image = item.product.featured_image
  endunless
-%}
<div class="il-cart-line"
     data-line-key="{{ item.key }}"
     data-line-index="{{ index }}"
     data-variant-id="{{ item.variant.id }}"
     data-qty="{{ item.quantity }}"
     data-product-image="{% if line_image %}{{ line_image | image_url: width: 533 }}{% endif %}"
     data-product='{{ item.product | json | escape }}'
     data-properties='{{ item.properties | json | escape }}'>

  <a href="{{ item.url }}" class="il-cart-line__image" aria-label="{{ item.product.title }}">
    {%- if line_image -%}
      <img src="{{ line_image | image_url: width: 360 }}"
           width="180" height="180"
           alt="{{ line_image.alt | default: item.product.title | escape }}" loading="lazy">
    {%- endif -%}
  </a>

  <div class="il-cart-line__body">
    <div class="il-cart-line__top">
      <a href="{{ item.url }}" class="il-cart-line__title">{{ item.product.title }}</a>
      <div class="il-cart-line__icons">
        <button class="il-cart-line__edit" type="button" aria-label="Editar">
          <span class="svg-wrapper">{{ 'icon-pencil.svg' | inline_asset_content }}</span>
        </button>
        <button class="il-cart-line__remove" type="button" aria-label="Remover">
          <span class="svg-wrapper">{{ 'icon-trash.svg' | inline_asset_content }}</span>
        </button>
      </div>
    </div>

    <div class="il-cart-line__meta">
      <div class="il-cart-line__variant">{{ item.variant.title }}</div>
      <div class="il-cart-line__price">
        {{ item.final_line_price | money }}
      </div>
    </div>

    <button class="il-cart-line__wishlist" type="button" data-move-to-wishlist>
      {{ 'general.move_to_favorites' | t | default: 'Mover para os favoritos' }}
    </button>
  </div>
</div>


