{% schema %}
{
  "name": "Sticky Product Bar",
  "settings": [],
  "presets": [
    {
      "name": "Sticky Product Bar"
    }
  ]
}
{% endschema %}

{% comment %} Create a dummy block object with default settings {% endcomment %}
{% assign dummy_block = '{ "settings": { "picker_type": "button", "swatch_shape": "circle" }, "shopify_attributes": "" }' | parse_json %}

{% unless product.has_only_default_variant %}
  {{ 'component-product-variant-picker.css' | asset_url | stylesheet_tag }}
  {{ 'component-swatch.css' | asset_url | stylesheet_tag }}
  {{ 'swatches-cheyenne.css' | asset_url | stylesheet_tag }}
{% endunless %}
{{ 'component-swatch-input.css' | asset_url | stylesheet_tag }}
{{ 'component-product-variant-picker.css' | asset_url | stylesheet_tag }}
{{ 'component-swatch.css' | asset_url | stylesheet_tag }}
{{ 'swatches-cheyenne.css' | asset_url | stylesheet_tag }}

<style>

@media (min-width: 750px) {
  #sticky-product-bar {
    display: none;
  }
}
  
@media (max-width: 749px) {
/* Sticky Product Bar Outer Container */
#sticky-product-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background-color: #ffffff;
  box-shadow: 0 -1px 15px rgba(0, 0, 0, 0.1);
  transform: translateY(0);
  transition: transform 0.25s ease;
  height: auto; /* Static height */
  overflow: visible;
  z-index: 1000;
  cursor: default;
}

.sticky-bar-inner {
  height: auto;
  overflow: hidden;
}

.drawer-content {
  display: none !important; /* Hide all non-essential drawer content */
}

/* Small “grab” bar indicator */
#sticky-product-bar::before { display: none; }

/* Ensure any internal size-chart, related, footer blocks are hidden */
#sticky-product-bar .size-chart,
#sticky-product-bar .mobile-related-products,
#sticky-product-bar .drawer-footer { display: none !important; }

/* Hidden state when recommendations are visible */
#sticky-product-bar.is-hidden-by-recs { transform: translateY(110%); pointer-events: none; }

/* Variant label adjustments */
#variant-selects-template--24455438926148__sticky_product_bar_HRGKtD > div > label {
  display: none;
}
#variant-selects-template--24455438926148__sticky_product_bar_HRGKtD > fieldset.js.product-form__input.product-form__input--pill > legend {
  display: none;
}
#variant-selects-template--24455438926148__sticky_product_bar_HRGKtD > fieldset.js.product-form__input.product-form__input--swatch > label {
  margin-top: 8px;
  margin-left: 1px;
  margin-right: 10px;
}
#variant-selects-template--24455438926148__sticky_product_bar_HRGKtD > fieldset.js.product-form__input.product-form__input--pill {
  margin-top: 4px;
}
.product-form__input--pill input[type=radio] + label {
  border-radius: 0% !important;
}

/* Layout/spacing tweaks */
#sticky-product-bar > .sticky-bar-inner > div.sticky-bar-summary {
  margin-left: 20px;
  margin-right: 20px;
  margin-top: 3px;
}
#ProductSubmitButton- {
  margin-top: -7px;
}

#variant-selects-template--24455438926148__sticky_product_bar_HRGKtD > fieldset.js.product-form__input.product-form__input--swatch,
#variant-selects-template--24455438926148__sticky_product_bar_HRGKtD > fieldset.js.product-form__input.product-form__input--pill {
  margin-inline: 0px!important;
}
#sticky-product-bar > div > div > div.sticky-bar-summary > div.product-title {
    font-family: "Figtree", Arial, Helvetica, sans-serif;
    font-weight: normal;
    font-size: 1.6rem;
    line-height: 2.2rem;
    text-decoration: none;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    color: black;
    margin-left: 5%;
    margin-top: 8px;
}

/* Variant picker layout */
#variant-selects-template--24455438926148__sticky_product_bar_HRGKtD {
  display: flex;
  flex-direction: row;
  justify-content: center;
  width: 100%;
  margin-top: 9px;
  gap: 2%;
}
#variant-selects-template--24455438926148__sticky_product_bar_HRGKtD > div:nth-child(1) > div > span.dropdown-swatch > span {
  width: 20px;
  height: 20px;
  border-radius: 50%;
}
#variant-selects-template--24455438926148__sticky_product_bar_HRGKtD > div {
  width: 44%;
}
#variant-selects-template--24455438926148__sticky_product_bar_HRGKtD > div > div > span.svg-wrapper {
  margin-right: 10px;
}

/* Price styling */
#sticky-product-bar > div > div > div.sticky-bar-summary > div.price_variants > div.product-price > div > div > div.price__sale {
  background-color: transparent;
}
#sticky-product-bar > div > div > div.sticky-bar-summary > div.price_variants > div.product-price > div {
  font-weight: bold!important;
  font-size: 15px!important;
  margin-left: 5%;
}
#sticky-product-bar > div.sticky-bar-inner > div > div.sticky-bar-summary > div.price_variants
  > div.product-price > div > div > div.price__sale > span.price-item.price-item--sale.price-item--last {
  color: #ff6f61;
  font-weight: bold;
}

  }


@media (min-width: 748px) { 
#sticky-product-bar > div.drawer-content > div.drawer-footer > footer > div.footer__content-top.page-width > div.mobile-menu > nav {
  display:none;
}
  }


.#sticky-product-bar > div.drawer-content > div.drawer-footer > footer {
  padding: 0px;
  background-color: fff; /* Light background for contrast */
}



#sticky-product-bar > div.drawer-content > div.mobile-related-products {
  margin-left: 0px;
  margin-right: 0px;
  margin-top: 70px!important;
}


  #sticky-product-bar > div.drawer-content > div.mobile-related-products > h2 {
    margin-left: 10%!important;
  }

  #sticky-product-bar > div.drawer-content > div.drawer-footer > footer > div.footer__content-top.page-width > div.mobile-menu > nav {
    padding: 0px!important;
  }

  #sticky-product-bar > div.drawer-content > div.drawer-footer > footer > div.footer__content-top.page-width {
    margin: 0px;
  }

  .footer__content-top {
    padding-bottom: 5rem!important;
}

  .footer-block--newsletter {
    margin-bottom: 70px;
}

  #sticky-product-bar > div.drawer-content > div.drawer-footer > footer > div.footer__content-top.page-width > div.mobile-menu {
    margin-top: 30px;
  }

.drawer-content .accordion-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
}

.drawer-content .accordion-button,
.drawer-content .accordion-content {
  pointer-events: auto;
}

  .drawer-modal {
  display: none; /* Hidden by default */
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5); /* Semi-transparent overlay */
  z-index: 2000; /* Ensure it's on top */
}

.drawer-modal-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #fff;
    padding: 20px;
    border-radius: 4px;
    max-width: 100%;
    max-height: 80%;
    width: 95%;
    height: 80%;
    overflow-y: auto;
}

.drawer-close {
  position: absolute;
  top: 10px;
  right: 10px;
  background: none;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
}

.size-chart {
  margin-top: 10px;
  margin-left: 4%;
  margin-bottom: 6px;

}
</style>

<!-- Provide the product data in JSON -->
<script>
  var productData = {{ product | json }};
</script>

<!-- Sticky Product Bar Container -->
<div id="sticky-product-bar" class="sticky-bar" aria-expanded="false">
  <div class="sticky-bar-inner">
    <div class="sticky-bar-header">
      <!-- Left side: Title, Price (variants moved to drawer) -->
      <div class="sticky-bar-summary">
        <div class="product-title">
          {{ product.title }}
        </div>
        <div class="price_variants">
          <div class="product-price">
            {% render 'price', product: product, use_variant: true, show_badges: true %}
          </div>
          {# Variant picker removed from sticky bar; shown in separate drawer #}
        </div>
      </div>
      <!-- Right side: Add to Cart button opens variant drawer -->
      <div class="add-to-cart">
        <button type="button" class="product-form__submit button button--full-width button--primary open-variant-drawer">
          <span>{{ 'products.product.add_to_cart' | t }}</span>
        </button>
      </div>
    </div>
  </div>
  <div class="size-chart">
  {% render 'size-chart' %}
    </div>
  <!-- Drawer Content (kept hidden on mobile) -->
  <div class="drawer-content" style="background: #fff;">
    <div class="drawer-description" style="color: #333; font-size: 14px; line-height: 1.5; margin-left: 5%; margin-right: 5%; margin-top: 4rem;">
      {{ product.content }}
    </div>

  <!-- Accordion: Added below the product description -->
  <div class="product-info-accordion" style="margin: 5rem 5%; z-index:1000;">
    <div class="accordion-item">
      <button class="accordion-button" aria-expanded="false">
        Composição e cuidados
      </button>
      <div class="accordion-content">
        <p>
          Exemplo: 100% Algodão. Lavar à máquina a 30°C.
        </p>
      </div>
    </div>

    <div class="accordion-item">
      <button class="accordion-button" aria-expanded="false">
        Envios, trocas e devoluções
      </button>
      <div class="accordion-content">
        <!-- <p>
          Exemplo: Entrega em 2-3 dias úteis. Trocas e devoluções até 30 dias.
        </p> --> 
      </div>
    </div>

    <div class="accordion-item">
      <button class="accordion-button" aria-expanded="false">
        Disponibilidade na loja
      </button>
      <div class="accordion-content">
        <p>
          Exemplo: Disponível em todas as lojas da região.
        </p>
      </div>
    </div>

    <div class="accordion-item">
      <button class="accordion-button" aria-expanded="false">
        Partilhar
      </button>
      <div class="accordion-content">
        <p>
          <a href="#">Facebook</a> | <a href="#">Instagram</a> | <a href="#">Twitter</a>
        </p>
      </div>
    </div>
  </div>
